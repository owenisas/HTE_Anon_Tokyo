/* ================================================================== */
/*  Auto-detect — highlight tainted text with background color        */
/* ================================================================== */

/* Watermark tag found + CRC valid = confirmed AI text */
.zwm-tainted-watermark {
  background: rgba(239, 68, 68, 0.25) !important;
  outline: 2px solid #ef4444 !important;
  outline-offset: 1px;
  border-radius: 3px;
  cursor: help;
  transition: background 0.2s;
}

.zwm-tainted-watermark:hover {
  background: rgba(239, 68, 68, 0.4) !important;
}

/* Watermark tag found but CRC invalid = suspicious */
.zwm-tainted-suspicious {
  background: rgba(245, 158, 11, 0.2) !important;
  outline: 2px solid #f59e0b !important;
  outline-offset: 1px;
  border-radius: 3px;
  cursor: help;
  transition: background 0.2s;
}

.zwm-tainted-suspicious:hover {
  background: rgba(245, 158, 11, 0.35) !important;
}

/* Zero-width chars present but no structured tag */
.zwm-tainted {
  background: rgba(168, 85, 247, 0.18) !important;
  outline: 2px solid #a855f7 !important;
  outline-offset: 1px;
  border-radius: 3px;
  cursor: help;
  transition: background 0.2s;
}

.zwm-tainted:hover {
  background: rgba(168, 85, 247, 0.32) !important;
}

/* Editable fields (textarea/input/contenteditable) */
.zwm-field-watermark {
  outline: 2px solid #ef4444 !important;
  box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.18) inset !important;
}

.zwm-field-suspicious {
  outline: 2px solid #f59e0b !important;
  box-shadow: 0 0 0 2px rgba(245, 158, 11, 0.18) inset !important;
}

.zwm-field-tainted {
  outline: 2px solid #a855f7 !important;
  box-shadow: 0 0 0 2px rgba(168, 85, 247, 0.16) inset !important;
}

/* ================================================================== */
/*  Selection scan — floating verdict badge                           */
/* ================================================================== */

#zwm-float {
  position: fixed;
  z-index: 2147483647;
  width: 320px;
  padding: 14px 16px;
  border-radius: 12px;
  font-family: "Segoe UI", system-ui, -apple-system, sans-serif;
  font-size: 13px;
  line-height: 1.5;
  box-shadow: 0 8px 32px rgba(0, 0, 0, .45), 0 0 0 1px rgba(255,255,255,.06);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  opacity: 0;
  transform: translateY(8px) scale(.96);
  transition: opacity .18s, transform .18s;
  pointer-events: none;
}

#zwm-float.zwm-float-visible {
  opacity: 1;
  transform: translateY(0) scale(1);
  pointer-events: auto;
}

.zwm-float-alert {
  background: rgba(127, 29, 29, .92);
  border: 1px solid #f87171;
  color: #fecaca;
}

.zwm-float-warn {
  background: rgba(66, 32, 6, .92);
  border: 1px solid #f59e0b;
  color: #fde68a;
}

.zwm-float-clean {
  background: rgba(5, 46, 22, .92);
  border: 1px solid #22c55e;
  color: #bbf7d0;
}

.zwm-float-header {
  font-size: 14px;
  font-weight: 700;
  margin-bottom: 6px;
}

.zwm-float-detail {
  font-size: 12px;
  opacity: .85;
  margin-bottom: 4px;
}

.zwm-float-meta {
  font-size: 11px;
  opacity: .55;
  border-top: 1px solid rgba(255,255,255,.1);
  padding-top: 6px;
  margin-top: 4px;
}

/* Verify Provenance button */
.zwm-float-verify-btn {
  display: block;
  width: 100%;
  margin-top: 8px;
  padding: 6px 12px;
  border: 1px solid rgba(125, 211, 252, 0.4);
  border-radius: 6px;
  background: rgba(125, 211, 252, 0.12);
  color: #7dd3fc;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.15s, border-color 0.15s;
  font-family: inherit;
}

.zwm-float-verify-btn:hover {
  background: rgba(125, 211, 252, 0.25);
  border-color: #7dd3fc;
}

/* Verification result */
.zwm-verify-result {
  margin-top: 8px;
  padding: 8px 10px;
  border-radius: 6px;
  font-size: 11px;
  line-height: 1.5;
}

.zwm-verify-ok {
  background: rgba(34, 197, 94, 0.15);
  border: 1px solid rgba(34, 197, 94, 0.4);
  color: #bbf7d0;
}

.zwm-verify-fail {
  background: rgba(239, 68, 68, 0.15);
  border: 1px solid rgba(239, 68, 68, 0.4);
  color: #fecaca;
}

.zwm-verify-hash {
  font-family: "SF Mono", "Consolas", "Monaco", monospace;
  font-size: 10px;
  opacity: 0.7;
}
